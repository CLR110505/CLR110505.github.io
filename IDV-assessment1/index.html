<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PSI Readings Table (Alternate)</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    h1 {
      margin-bottom: 5px;
    }
    #timestamp {
      color: #555;
      font-size: 0.9em;
      margin-bottom: 15px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background: #f7f7f7;
    }
  </style>
</head>
<body>

  <h1>Realtime PSI Readings</h1>
  <div id="timestamp"></div>

  <table id="psiTable">
    <thead>
      <tr>
        <th>Reading Type</th>
        <th>National</th>
        <th>North</th>
        <th>South</th>
        <th>East</th>
        <th>West</th>
        <th>Central</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    window.onload = function() {
      fetch('https://api.data.gov.sg/v1/environment/psi')
        .then(response => response.json())
        .then(data => {
          const readings = data.items[0].readings;
          const time = data.items[0].timestamp;
          document.getElementById('timestamp').textContent = 'Timestamp: ' + time;

          const tbody = document.querySelector('#psiTable tbody');

          // Clear any previous rows (if refreshing)
          tbody.innerHTML = '';

          for (const type in readings) {
            const row = tbody.insertRow();

            const cellType = row.insertCell();
            cellType.textContent = type;

            const regions = ['national', 'north', 'south', 'east', 'west', 'central'];
            regions.forEach(region => {
              const cell = row.insertCell();
              cell.textContent = readings[type][region] ?? '-';
            });
          }
        })
        .catch(error => {
          console.error('Error fetching PSI data:', error);
        });
    };
  </script>

</body>
</html>
